1.
CREATE VIEW SMALL_PROPERTY AS
SELECT
    PROPERTY_ID,
    OFFICE_NUM,
    BDRMS,
    FLOORS,
    MONTHLY_RENT,
    OWNER_NUM
FROM
    PROPERTY
WHERE
    SQR_FT < 1250;
	
2.	
SELECT OFFICE_NUM, PROPERTY_ID, MONTHLY_RENT
FROM SMALL_PROPERTY
WHERE MONTHLY_RENT >= 1150;

3.
SELECT OFFICE_NUM, PROPERTY_ID, MONTHLY_RENT
FROM PROPERTY
WHERE SQR_FT < 1250 AND MONTHLY_RENT <= 1150;
4.
CREATE VIEW PROPERTY_OWNERS AS
SELECT
    P.PROPERTY_ID,
    P.OFFICE_NUM,
    P.SQR_FT,
    P.BDRMS,
    P.FLOORS,
    P.MONTHLY_RENT,
    O.LAST_NAME
FROM
    PROPERTY P
JOIN
    OWNER O
ON
    P.OWNER_NUM = O.OWNER_NUM
WHERE
    P.BDRMS = 3;

5.
SELECT *
FROM PROPERTY_OWNERS
WHERE MONTHLY_RENT < 1675;

6.
SELECT P.PROPERTY_ID, P.OFFICE_NUM, P.SQR_FT, P.BDRMS, P.FLOORS, P.MONTHLY_RENT, O.LAST_NAME AS LAST_NAME
FROM PROPERTY P
JOIN OWNER O
ON P.OWNER_NUM = O.OWNER_NUM
WHERE P.BDRMS = 3 AND P.MONTHLY_RENT < 1675;
7.
CREATE VIEW MONTHLY_RENTS AS
SELECT
    BDRMS AS BEDROOMS,
    AVG(SQR_FT) AS AVG_SQUARE_FEET,
    AVG(MONTHLY_RENT) AS AVG_MONTHLY_RENT
FROM
    PROPERTY
GROUP BY BEDROOMS
ORDER BY BEDROOMS;

8.
SELECT AVG_SQUARE_FEET, AVG_MONTHLY_RENT
FROM MONTHLY_RENTS
WHERE AVG_MONTHLY_RENT > 1400;

9.
SELECT AVG(SQR_FT) AS AVG_SQUARE_FEET, AVG(MONTHLY_RENT) AS AVG_MONTHLY_RENT
FROM PROPERTY
GROUP BY BDRMS
HAVING AVG_MONTHLY_RENT < 1400
ORDER BY BDRMS;
10.
USE StayWell;
GRANT SELECT ON PROPERTY TO Oliver;

